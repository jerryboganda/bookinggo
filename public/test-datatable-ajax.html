<!DOCTYPE html>
<html>
<head>
    <title>DataTable AJAX Test</title>
    <style>
        body { font-family: Arial; padding: 20px; }
        pre { background: #f5f5f5; padding: 15px; border-radius: 5px; overflow-x: auto; }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>üîç DataTable AJAX Endpoint Test</h1>
    
    <h2>Testing AJAX endpoint:</h2>
    <p><strong>URL:</strong> <span id="ajax-url"></span></p>
    
    <button onclick="testAjax()" style="padding: 10px 20px; font-size: 16px; cursor: pointer;">Test AJAX Request</button>
    
    <h2>Response:</h2>
    <div id="result"></div>
    
    <script>
        // Get the DataTable AJAX URL
        var ajaxUrl = window.location.origin + '/users/list/view';
        document.getElementById('ajax-url').textContent = ajaxUrl;
        
        function testAjax() {
            document.getElementById('result').innerHTML = '<p>‚è≥ Loading...</p>';
            
            fetch(ajaxUrl, {
                method: 'GET',
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                    'Accept': 'application/json'
                }
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('HTTP ' + response.status + ': ' + response.statusText);
                }
                return response.json();
            })
            .then(data => {
                document.getElementById('result').innerHTML = 
                    '<p class="success">‚úÖ SUCCESS</p>' +
                    '<p><strong>Data Type:</strong> ' + typeof data + '</p>' +
                    '<p><strong>Has "data" property:</strong> ' + ('data' in data ? 'Yes' : 'No') + '</p>' +
                    (data.data ? '<p><strong>Records count:</strong> ' + data.data.length + '</p>' : '') +
                    '<pre>' + JSON.stringify(data, null, 2) + '</pre>';
            })
            .catch(error => {
                document.getElementById('result').innerHTML = 
                    '<p class="error">‚ùå ERROR: ' + error.message + '</p>' +
                    '<p>This usually means:</p>' +
                    '<ul>' +
                    '<li>The route requires authentication (login first)</li>' +
                    '<li>The endpoint returns HTML instead of JSON</li>' +
                    '<li>There\'s a server error (check Laravel logs)</li>' +
                    '</ul>';
            });
        }
        
        // Auto-test on page load
        window.onload = function() {
            setTimeout(testAjax, 500);
        };
    </script>
</body>
</html>
